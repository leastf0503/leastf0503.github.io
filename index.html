<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VitalCore - Ihr Gesundheitsportal</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        @keyframes slide-up { from { transform: translateY(100%); } to { transform: translateY(0); } }
        @keyframes fade-in { from { opacity: 0; } to { opacity: 1; } }
        @keyframes pulse-slow { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.05); } }
        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

        @keyframes blink {
          0%, 88%, 100% { transform: scaleY(1); }
          92% { transform: scaleY(0.05); }
        }

        .animate-blink-1 {
          animation: blink 2.5s infinite;
          transform-origin: center;
        }

        .animate-blink-2 {
          animation: blink 2.5s infinite;
          animation-delay: 0.4s;
          transform-origin: center;
        }

        .animate-slide-up { animation: slide-up 0.5s ease-out forwards; }
        .animate-fade-in { animation: fade-in 0.8s ease-out forwards; }
        .animate-pulse-slow { animation: pulse-slow 3s infinite; }
        .animate-spin-slow { animation: spin 3s linear infinite; }
        
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f8fafc; }
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        #error-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; padding: 20px; background: #fee2e2; border-bottom: 2px solid #ef4444; color: #991b1b; z-index: 9999; font-family: monospace; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
    </style>
</head>
<body>

    <div id="error-overlay">
        <strong>Systemfehler:</strong> <span id="error-msg">Unbekannter Fehler</span>
    </div>
    <script>
        window.onerror = function(msg, url, line, col, error) {
            document.getElementById('error-overlay').style.display = 'block';
            document.getElementById('error-msg').innerText = msg + " (Zeile: " + line + ")";
            return false;
        };
    </script>

    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // 1. KONFIGURATION
        const MIN_BROWSING_TIME_1 = 5; 
        const MIN_REGISTRATION_TIME = 20; 
        const MIN_BROWSING_TIME_2 = 40; 
        const COOKIE_BANNER_DELAY_MS = 4000; 
        const SOSCI_BASE_URL = "https://www.soscisurvey.de/BA25LeaPaula/";

        // 2. ICONS & ASSETS
        const Icon = ({ path, className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>{path}</svg>
        );

        const RealisticEye = ({ color, className, hasLashes }) => {
            const gradId = React.useId().replace(/:/g, ""); 
            return (
                <svg viewBox="0 0 100 70" className={className} preserveAspectRatio="xMidYMid meet" style={{ overflow: 'visible' }}>
                    <defs>
                        <radialGradient id={`whiteGrad-${gradId}`} cx="50%" cy="50%" r="50%" fx="50%" fy="30%">
                            <stop offset="0%" stopColor="#ffffff" />
                            <stop offset="80%" stopColor="#ffffff" />
                            <stop offset="100%" stopColor="#d1d5db" />
                        </radialGradient>
                        <radialGradient id={`irisGrad-${gradId}`}>
                            <stop offset="20%" stopColor="#111" />
                            <stop offset="40%" stopColor={color} />
                            <stop offset="100%" stopColor="#000" stopOpacity="0.8" />
                        </radialGradient>
                    </defs>
                    <g className="animate-blink-1">
                        {hasLashes && (
                            <g stroke="#1a1a1a" strokeWidth="1.2" fill="none" strokeLinecap="round" opacity="0.8">
                                <path d="M15,28 Q10,15 5,12" /><path d="M25,23 Q20,10 15,8" /><path d="M35,20 Q32,8 28,5" />
                                <path d="M50,18 Q50,8 50,4" /><path d="M65,20 Q68,8 72,5" /><path d="M75,23 Q80,10 85,8" /><path d="M85,28 Q90,15 95,12" />
                            </g>
                        )}
                        <path d="M5,35 Q50,-12 95,35 Q50,82 5,35 Z" fill={`url(#whiteGrad-${gradId})`} stroke="#4b5563" strokeWidth="0.5" />
                        <circle cx="50" cy="35" r="17" fill={`url(#irisGrad-${gradId})`} />
                        {[...Array(12)].map((_, i) => (
                            <line key={i} x1="50" y1="35" x2={50 + 15 * Math.cos(i * 30 * Math.PI/180)} y2={35 + 15 * Math.sin(i * 30 * Math.PI/180)} stroke="rgba(255,255,255,0.1)" strokeWidth="0.5" />
                        ))}
                        <circle cx="50" cy="35" r="8" fill="#000" />
                        <circle cx="45" cy="30" r="3.5" fill="#fff" opacity="0.8" />
                        <circle cx="56" cy="40" r="1.5" fill="#fff" opacity="0.4" />
                    </g>
                </svg>
            );
        };

        const paths = {
            shield: <React.Fragment><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10"/><path d="M12 8v4"/><path d="M12 16h.01"/></React.Fragment>,
            check: <React.Fragment><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><path d="m9 11 3 3L22 4"/></React.Fragment>,
            user: <React.Fragment><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></React.Fragment>,
            search: <React.Fragment><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></React.Fragment>,
            arrowRight: <path d="M5 12h14m-7-7 7 7-7 7"/>,
            arrowLeft: <path d="M19 12H5m7 7-7-7 7-7"/>,
            leaf: <path d="M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z" />,
            clock: <circle cx="12" cy="12" r="10"/>,
            activity: <path d="M22 12h-4l-3 9L9 3l-3 9H2"/>,
            apple: <React.Fragment><path d="M12 20.94c1.5 0 2.75 1.06 4 1.06 3 0 6-8 6-12.22A4.91 4.91 0 0 0 17 5c-2.22 0-4 1.44-5 2-1-.56-2.78-2-5-2a4.9 4.9 0 0 0-5 4.78C2 14 5 22 8 22c1.25 0 2.5-1.06 4-1.06Z"/><path d="M10 2c1 .5 2 2 2 5"/></React.Fragment>,
            coffee: <React.Fragment><path d="M17 8h1a4 4 0 1 1 0 8h-1"/><path d="M3 8h14v9a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4Z"/><line x1="6" x2="6" y1="2" y2="4"/><line x1="10" x2="10" y1="2" y2="4"/><line x1="14" x2="14" y1="2" y2="4"/></React.Fragment>,
            heart: <path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"/>,
            heartFilled: <path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z" fill="currentColor" stroke="none"/>,
            star: <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2" />,
            ciagrette: <React.Fragment><path d="M18 8c0-2.5-2-2.5-2-5"/><path d="M22 8c0-2.5-2-2.5-2-5"/><rect x="2" y="13" width="20" height="6" rx="2"/><path d="M22 16h-4"/><path d="M2 16h4"/></React.Fragment>,
        };

        // 3. DATEN
const BLOG_CONTENT = [
            { 
                id: 1, 
                title: "Die 5 S√§ulen Ihrer Langlebigkeit", 
                cat: "Forschung", 
                time: "12 min", 
                date: "Aktuell", 
                author: "Dr. med. Weber", 
                image: "https://images.unsplash.com/photo-1476480862126-209bfaa8edc8?auto=format&fit=crop&w=800&q=80", 
                desc: "Erfahren Sie, wie kleine Anpassungen in Ihrer t√§glichen Routine Ihr biologisches Alter messbar senken k√∂nnen.", 
                fullText: [
                    "Langlebigkeit ist mehr als ein langes Leben. Es geht darum, m√∂glichst viele Jahre gesund, geistig klar und k√∂rperlich leistungsf√§hig zu bleiben. Die moderne Wissenschaft spricht dabei von Healthspan ‚Äì der gesunden Lebensspanne ‚Äì im Gegensatz zur blo√üen Lebensdauer (Lifespan). Doch was entscheidet wirklich dar√ºber, wie wir altern? Studien zeigen, dass bis zu 80 % unserer Langlebigkeit durch beeinflussbare Faktoren wie den Lebensstil bestimmt werden.",
                    "Wahre Langlebigkeit bedeutet: k√∂rperlich beweglich bleiben, geistig leistungsf√§hig sein, ein starkes Immunsystem haben sowie emotionale Stabilit√§t und Lebensfreude bewahren. Kurz gesagt: Mehr Lebensqualit√§t bis ins hohe Alter. Dieser Artikel stellt Ihnen die f√ºnf zentralen S√§ulen vor ‚Äì wissenschaftlich fundiert und praxisnah erkl√§rt.",
                    "S√§ule 1: Ern√§hrung ‚Äì Ihr t√§glicher Einfluss auf Ihre Zellgesundheit. Unsere Zellen erneuern sich st√§ndig. Die Qualit√§t der 'Bausteine', die wir ihnen liefern, entscheidet √ºber Reparaturprozesse und Entz√ºndungswerte. Eine langlebigkeitsf√∂rdernde Ern√§hrung ist pflanzenbetont (Gem√ºse, Beeren), reich an hochwertigen Fetten (Omega-3) und Proteinen, w√§hrend Zucker und hochverarbeitete Lebensmittel reduziert werden. Auch Intervallfasten aktiviert wichtige Langlebigkeitsgene wie Sirtuine.",
                    "S√§ule 2: Bewegung ‚Äì Der st√§rkste Hebel gegen biologisches Altern. Regelm√§√üige Bewegung wirkt wie ein Anti-Aging-Medikament ohne Nebenwirkungen. Die Kombination aus Krafttraining (Muskelerhalt), Ausdauertraining (Herz-Lunge & Mitochondrien) sowie Beweglichkeit (Yoga/Tai Chi) ist entscheidend. Bereits 150 Minuten moderate Bewegung pro Woche zeigen messbare Effekte auf die Lebenserwartung.",
                    "S√§ule 3: Schlaf & Regeneration ‚Äì Die untersch√§tzte Grundlage. Schlaf ist eine hochaktive Reparaturzeit. W√§hrenddessen regenerieren sich Zellen, das Gehirn wird 'gereinigt' und das Immunsystem gest√§rkt. Chronischer Schlafmangel beschleunigt hingegen Alterungsprozesse und f√∂rdert Krankheiten wie Diabetes. 7‚Äì9 Stunden in einer k√ºhlen, dunklen Umgebung gelten als optimal.",
                    "S√§ule 4: Mentale Gesundheit & Stressmanagement. Dauerstress erh√∂ht den Cortisolspiegel und sch√§digt Zellen sowie Gef√§√üe. Wege zu mehr Resilienz sind Achtsamkeit, Meditation und bewusste Pausen im Alltag. Menschen mit guter Stressbew√§ltigung leben nicht nur l√§nger, sondern erleben ihr Leben intensiver und zufriedener.",
                    "S√§ule 5: Soziale Beziehungen & Sinnhaftigkeit. Menschen mit stabilen sozialen Bindungen leben l√§nger als isolierte Personen. Positive Beziehungen senken Stress und geben emotionalen Halt. Ein Gef√ºhl von Sinn ‚Äì sei es durch Familie, Beruf oder Ehrenamt ‚Äì wirkt wie ein mentales Schutzschild gegen Alterungsprozesse.",
                    "Fazit: Langlebigkeit entsteht im Zusammenspiel dieser Faktoren. Gute Ern√§hrung verbessert den Schlaf, Bewegung reduziert Stress und soziale Kontakte f√∂rdern gesunde Routinen. Beginnen Sie heute mit kleinen Schritten: 10 Minuten Bewegung oder eine Gem√ºseportion mehr haben bereits eine gro√üe Wirkung. Konsequenz schl√§gt Perfektion."
                ]
            },
            { 
                id: 2, 
                title: "Intervallfasten 16:8 f√ºr Einsteiger", 
                cat: "Ern√§hrung", 
                time: "10 min", 
                date: "10. Okt", 
                author: "Sarah Klein", 
                image: "https://images.unsplash.com/photo-1498837167922-ddd27525d352?auto=format&fit=crop&w=800", 
                desc: "Warum zeitlich begrenzte Esspausen f√ºr Ihren Stoffwechsel wertvoller sind als jede klassische Kalorien-Di√§t.", 
                fullText: [
                    "Intervallfasten, auch intermittierendes Fasten genannt, ist keine klassische Di√§t, sondern ein Essensrhythmus. Dabei geht es weniger darum, WAS gegessen wird, sondern WANN. Der Wechsel zwischen Phasen der Nahrungsaufnahme und bewusstem Verzicht gibt dem K√∂rper Zeit zur Regeneration und optimiert Stoffwechselprozesse.",
                    "Die 16:8-Methode einfach erkl√§rt: Sie fasten 16 Stunden und essen innerhalb eines Fensters von 8 Stunden. Ein klassisches Beispiel ist die letzte Mahlzeit um 20:00 Uhr und die erste Mahlzeit am Folgetag um 12:00 Uhr. W√§hrend der Fastenzeit sind ausschlie√ülich kalorienfreie Getr√§nke wie Wasser, unges√º√üter Tee oder schwarzer Kaffee erlaubt.",
                    "Warum 16:8 so effektiv ist: Die Methode l√§sst sich leicht in den Alltag integrieren, da oft nur das Fr√ºhst√ºck weggelassen wird. Neben der Unterst√ºtzung beim Gewichtsmanagement stabilisiert Fasten den Insulinspiegel, f√∂rdert die Fettverbrennung und reduziert Entz√ºndungsprozesse. Viele Anwender berichten zudem von gesteigerter mentaler Klarheit und weniger Hei√ühunger.",
                    "F√ºr wen ist Intervallfasten geeignet? Gesunde Erwachsene und Menschen, die ihr Gewicht regulieren m√∂chten, profitieren besonders. Nicht oder nur eingeschr√§nkt geeignet ist es hingegen f√ºr Schwangere, Stillende, Menschen mit Essst√∂rungen, Untergewicht oder bestimmten Vorerkrankungen wie Diabetes Typ 1. Im Zweifel sollte immer √§rztlicher Rat eingeholt werden.",
                    "Der richtige Start f√ºr Anf√§nger: Beginnen Sie sanft mit Rhythmen wie 12:12 oder 14:10 und steigern Sie sich langsam auf 16 Stunden. W√§hlen Sie Ihr Essensfenster so, dass es zu Ihrem sozialen Leben und Arbeitsalltag passt. Wichtig: Das Fastenfenster ist kein Freibrief f√ºr Fast Food ‚Äì setzen Sie auf Gem√ºse, hochwertige Proteine und gesunde Fette.",
                    "Typische Anf√§ngerfehler vermeiden: Essen Sie w√§hrend der 8 Stunden ausreichend, um Hei√ühungerattacken vorzubeugen. Geben Sie Ihrem K√∂rper zudem mindestens 2 bis 3 Wochen Zeit, um sich an die Umstellung zu gew√∂hnen. Achten Sie auch auf versteckte Kalorien in Getr√§nken wie Milch im Kaffee, da diese den Fastenzustand unterbrechen k√∂nnen.",
                    "Was passiert im K√∂rper? Nach etwa 4 bis 6 Stunden sinkt der Insulinspiegel. Ab ca. 12 Stunden greift der K√∂rper verst√§rkt auf Fettreserven zur√ºck. Ein besonderes Highlight ist die Autophagie, die nach etwa 14 bis 16 Stunden Fasten intensiviert wird ‚Äì ein zellul√§rer Reinigungsprozess, bei dem besch√§digte Zellstrukturen abgebaut und erneuert werden.",
                    "Fazit: Intervallfasten ist ein wertvolles Werkzeug f√ºr langfristige Gesundheit. Es sollte nicht als kurzfristige Verzichtskur, sondern als nachhaltige Routine verstanden werden. Wenn Sie auf die Qualit√§t Ihrer Nahrung achten und auf Ihren K√∂rper h√∂ren, kann 16:8 Ihre Lebensqualit√§t und Ihr Wohlbefinden massiv steigern."
                ]
            },
            { 
                id: 3, 
                title: "Digital Detox & Ihr Cortisolspiegel", 
                cat: "Mental Health", 
                time: "15 min", 
                date: "08. Okt", 
                author: "M. Psych. Bauer", 
                image: "https://images.unsplash.com/photo-1544716278-ca5e3f4abd8c?auto=format&fit=crop&w=800&q=80", 
                desc: "Wie die st√§ndige Erreichbarkeit Ihr Gehirn in einen Alarmzustand versetzt und was Sie dagegen tun k√∂nnen.", 
                fullText: [
                    "Smartphones und Laptops begleiten uns heute permanent. Push-Nachrichten und soziale Feeds sorgen daf√ºr, dass unser Gehirn kaum noch echte Ruhephasen erlebt. Dieser digitale Dauerstress hat einen direkten Einfluss auf unseren Cortisolspiegel ‚Äì das wichtigste Stresshormon des K√∂rpers, das im √úberma√ü unsere Gesundheit und Langlebigkeit gef√§hrdet.",
                    "Was ist Cortisol und wie wirkt es? Cortisol ist ein lebensnotwendiges Hormon der Nebennierenrinde, das den Blutzucker reguliert, Energie bereitstellt und das Immunsystem steuert. Im gesunden Zustand folgt es einem Rhythmus: morgens hoch, um uns wach zu machen, und abends niedrig, um Schlaf zu erm√∂glichen. Digitale Reiz√ºberflutung st√∂rt diesen Rhythmus und h√§lt das Nervensystem in einer permanenten Alarmbereitschaft.",
                    "Wie digitale Medien Stress ausl√∂sen: Jede Benachrichtigung aktiviert das sympathische Nervensystem ‚Äì den sogenannten 'Fight-or-Flight'-Modus. Das Gehirn stuft digitale Unterbrechungen als potenziell relevant ein, was die Cortisolaussch√ºttung triggert. Zudem hemmen Bildschirme durch ihr blaues Licht die Melatoninproduktion, was zu schlechterem Schlaf f√ºhrt. Ein Teufelskreis entsteht, da Schlafmangel den Cortisolspiegel am Folgetag zus√§tzlich erh√∂ht.",
                    "Die Folgen von chronischem digitalem Stress: Ein dauerhaft erh√∂hter Cortisolspiegel ist ein stiller Treiber f√ºr Ersch√∂pfung, Burnout und physische Beschwerden. Er beg√ºnstigt die Einlagerung von viszeralem Bauchfett, erh√∂ht das Diabetesrisiko durch Insulinresistenz und schw√§cht langfristig das Immunsystem. Auf zellul√§rer Ebene beschleunigt chronischer Stress die Alterungsprozesse massiv.",
                    "Was bedeutet Digital Detox wirklich? Es geht nicht um Technikfeindlichkeit, sondern um einen bewussten Umgang statt Dauerverf√ºgbarkeit. Ziel ist es, dem K√∂rper durch smartphone-freie Zeiten oder Social-Media-Pausen Raum zur Regeneration zu geben. Dadurch sinkt der Cortisolspiegel messbar ab und das parasympathische Nervensystem ‚Äì verantwortlich f√ºr Ruhe und Erholung ‚Äì wird wieder aktiv.",
                    "Praktische Strategien f√ºr den Alltag: Die '60-90-Minuten-Regel' empfiehlt nach sp√§testens 90 Minuten Bildschirmarbeit eine echte Pause ohne Handy. Ein 'digitaler Sonnenuntergang' (keine Bildschirme 60 Minuten vor dem Schlafen) verbessert die Schlafqualit√§t erheblich. Zudem hilft eine 'Benachrichtigungs-Di√§t', bei der nur lebensnotwendige Apps unterbrechen d√ºrfen, die mentale Last zu reduzieren.",
                    "Wissenschaftliche Vorteile von Auszeiten: Studien belegen, dass bereits kurze digitale Pausen die Herzfrequenzvariabilit√§t verbessern und die Konzentrationsf√§higkeit steigern. Wer offline-Rituale wie Spazierg√§nge oder Lesen pflegt, gewinnt nicht nur innere Ruhe, sondern senkt nachweislich die Entz√ºndungswerte im K√∂rper. Weniger Information bedeutet oft mehr Raum f√ºr echte Regeneration.",
                    "Fazit: Weniger Bildschirm bedeutet mehr Balance. Digital Detox ist ein Akt der Selbstf√ºrsorge in einer Welt permanenter Reiz√ºberflutung. Ein gesunder Cortisolspiegel ist die Basis f√ºr Energie, klares Denken und emotionales Gleichgewicht. In Kombination mit Bewegung und guter Ern√§hrung bildet der bewusste Medienverzicht eine entscheidende S√§ule f√ºr eine gesunde Langlebigkeit."
                ]
            },
            { 
                id: 4, 
                title: "Herzgesundheit: Vorsorge neu gedacht", 
                cat: "Pr√§vention", 
                time: "11 min", 
                date: "05. Okt", 
                author: "Prof. Dr. Lang", 
                image: "https://images.unsplash.com/photo-1505751172876-fa1923c5c528?auto=format&fit=crop&w=800", 
                desc: "Kennen Sie Ihre Blutwerte? Warum moderne Diagnostik weit √ºber einfaches Cholesterin hinausgeht.", 
                fullText: [
                    "Herz-Kreislauf-Erkrankungen sind die h√§ufigste Todesursache, doch viele Probleme werden erst erkannt, wenn sie bereits fortgeschritten sind. Ein neues Verst√§ndnis von Herzvorsorge bedeutet, nicht erst auf Symptome zu reagieren, sondern Pr√§vention als aktiven Lebensstil zu begreifen und Risikofaktoren ganzheitlich zu betrachten, bevor strukturelle Sch√§den entstehen.",
                    "Das Herz ist weit mehr als nur eine mechanische Pumpe. Mit rund 100.000 Schl√§gen t√§glich versorgt es den gesamten Organismus mit Sauerstoff und N√§hrstoffen. Herzgesundheit ist dabei das Ergebnis eines komplexen Zusammenspiels aus Stoffwechsel, Hormonhaushalt, Nervensystem und Entz√ºndungsprozessen. Eine moderne Vorsorge muss daher all diese Faktoren ber√ºcksichtigen, um ein vollst√§ndiges Bild der vaskul√§ren Integrit√§t zu erhalten.",
                    "Der Perspektivwechsel in der Diagnostik: Klassische Parameter wie Gesamtcholesterin oder ein Ruhe-EKG zeigen Auff√§lligkeiten oft erst sehr sp√§t. Moderne Herzvorsorge setzt auf Fr√ºhindikatoren wie die Herzfrequenzvariabilit√§t (HRV), Entz√ºndungsmarker (hs-CRP) und den Blutzucker-Langzeitwert (HbA1c). Auch der Taillenumfang ist oft aussagekr√§ftiger als der reine BMI, um das individuelle Risiko pr√§zise zu bewerten.",
                    "Zentrale Risikofaktoren im Fokus: Chronische, niedriggradige Entz√ºndungen und Insulinresistenz gelten heute als Haupttreiber f√ºr Arteriosklerose. Sie sch√§digen die Gef√§√üinnenw√§nde oft lange vor messbaren Cholesterinver√§nderungen. Ebenso wirken chronischer Stress und Bewegungsmangel als massive Stressoren f√ºr das Herz, das als Muskel auf regelm√§√üiges Training angewiesen ist, um leistungsf√§hig zu bleiben.",
                    "Ern√§hrung als Herzschutz: Die Qualit√§t der Nahrung ist entscheidend. Eine mediterrane Ern√§hrung, reich an Ballaststoffen aus Gem√ºse und H√ºlsenfr√ºchten sowie hochwertigen Omega-3-Fetts√§uren, kann das Risiko f√ºr Herzinfarkte signifikant senken. Die Reduktion von Zucker und stark verarbeiteten Lebensmitteln sch√ºtzt die Gef√§√üe vor Glykation und oxidativem Stress.",
                    "Bewegung ‚Äì das nat√ºrlichste Herzmedikament: Bereits 150 Minuten moderate Bewegung pro Woche senken Blutdruck, Ruhepuls und Entz√ºndungswerte deutlich. Eine Kombination aus Ausdauer- und Krafttraining st√§rkt nicht nur den Herzmuskel, sondern verbessert auch die Mitochondrienfunktion und die allgemeine Stoffwechsellage. Bewegung ist somit der st√§rkste Hebel gegen biologisches Altern des Herz-Kreislauf-Systems.",
                    "Die untersch√§tzte Verbindung ‚Äì Schlaf und mentale Gesundheit: Schlafmangel erh√∂ht Entz√ºndungsmarker und das Risiko f√ºr Rhythmusst√∂rungen, da er das autonome Nervensystem destabilisiert. Da das Herz sensibel auf emotionale Belastungen reagiert, ist aktives Stressmanagement und soziale Verbundenheit ein essenzieller Teil der Vorsorge. Menschen in stabilen sozialen Gef√ºgen weisen nachweislich ein geringeres Herzrisiko auf.",
                    "Fazit: Herzgesundheit beginnt heute und ist ein lebenslanger Prozess. Kleine, konsequente Ver√§nderungen in Ern√§hrung, Bewegung und Regeneration wirken st√§rker als radikale Kurzzeitprogramme. Ein gesundes Herz ist kein Zufall, sondern das Ergebnis bewusster Entscheidungen. Es schenkt uns nicht nur mehr Lebensjahre, sondern vor allem mehr Lebensqualit√§t bis ins hohe Alter."
                ]
            },
            { 
                id: 5, 
                title: "Toxikologische Belastung durch Rauchen", 
                cat: "Pr√§vention", 
                time: "9 min", 
                author: "Dr. Lisa Neubauer", 
                image: "https://cdn.prod.www.spiegel.de/images/caa850d5-0001-0004-0000-000001220757_w1200_r1_fpx41.97_fpy50.jpg", 
                desc: "Warum auch gelegentlicher Konsum Ihre DNA sch√§digt und wie Ihr K√∂rper regenerieren kann.", 
                fullText: [
                    "Rauchen ist weit mehr als nur ein Risiko f√ºr die Lunge; es ist eine chronische Selbstvergiftung. Der Begriff 'toxikologische Belastung' beschreibt dabei die Gesamtheit der √ºber 7.000 chemischen Substanzen im Zigarettenrauch, von denen mindestens 250 als giftig und √ºber 70 als krebserregend gelten. Diese Stoffe gelangen √ºber die Lunge direkt ins Blut, ohne die sch√ºtzenden Filtersysteme von Leber oder Darm zu passieren.",
                    "Die chemischen Hauptakteure: Nikotin wirkt als starkes Nervengift und ver√§ndert neuronale Signalwege, w√§hrend Kohlenmonoxid (CO) die Sauerstoffbindung im Blut blockiert und so die Versorgung aller Organe drosselt. Teerstoffe lagern sich im Lungengewebe ab, und hochgiftige Schwermetalle wie Cadmium, Blei und Arsen reichern sich √ºber Jahre in Nieren, Knochen und dem Nervensystem an. Fl√ºchtige Verbindungen wie Benzol und Formaldehyd sch√§digen zudem direkt die Zellstrukturen.",
                    "Der Weg der Gifte durch den K√∂rper: Mit einer Oberfl√§che von bis zu 100 m¬≤ bieten die Lungenbl√§schen (Alveolen) ideale Bedingungen f√ºr die blitzschnelle Aufnahme der Toxine. Viele dieser Stoffe sind lipophil (fettl√∂slich) und lagern sich bevorzugt im Fettgewebe, im Gehirn oder in Zellmembranen ab. Da einige dieser Substanzen Halbwertszeiten von mehreren Jahren haben, bleibt eine toxische Restbelastung oft noch lange nach dem Rauchstopp bestehen.",
                    "Zellul√§re Zerst√∂rung: Auf mikroskopischer Ebene erzeugt Rauchen massiven oxidativen Stress. Freie Radikale brechen DNA-Str√§nge und ver√§ndern Proteine, w√§hrend die k√∂rpereigenen antioxidativen Schutzmechanismen chronisch √ºberlastet sind. Gleichzeitig wird das Immunsystem dauerhaft aktiviert, was zu systemischen Entz√ºndungsreaktionen f√ºhrt ‚Äì die Grundlage f√ºr chronische Erkrankungen von COPD bis hin zur Arteriosklerose.",
                    "Organspezifische Effekte: W√§hrend in der Lunge die Zerst√∂rung der Flimmerh√§rchen und die Krebsentstehung im Vordergrund stehen, f√ºhrt die Belastung im Herz-Kreislauf-System zu Gef√§√üverengungen und einer erh√∂hten Gerinnungsneigung. Auch die Leber als zentrales Entgiftungsorgan wird massiv beansprucht, was den Abbau anderer Schadstoffe und Medikamente beeintr√§chtigt. Im Gehirn steigt durch neurotoxische Effekte das Schlaganfallrisiko und der kognitive Abbau wird beschleunigt.",
                    "Passivrauchen und die 'sichere Dosis': Aus toxikologischer Sicht gibt es keine sichere Untergrenze f√ºr das Rauchen. Besonders krebserregende Stoffe wirken oft exponentiell zur Dauer der Exposition. Auch Passivraucher sind gef√§hrdet, da der Nebenstromrauch einer glimmenden Zigarette teilweise h√∂here Konzentrationen an Toxinen enth√§lt als der vom Raucher inhalierte Hauptstromrauch, da er bei niedrigeren Temperaturen entsteht.",
                    "Regeneration und Restrisiko: Das Regenerationspotenzial des K√∂rpers ist bemerkenswert. Bereits 24 Stunden nach dem Rauchstopp sinkt der Kohlenmonoxidspiegel im Blut messbar. W√§hrend sich die Lungenfunktion √ºber Wochen verbessert und das Krebsrisiko √ºber Jahre sinkt, bleiben bestimmte Sch√§den ‚Äì insbesondere durch Schwermetallanreicherung oder irreversible DNA-Ver√§nderungen ‚Äì teilweise bestehen. Je fr√ºher der Stopp, desto geringer die lebenslange Gesamtbelastung.",
                    "Fazit: Rauchen ist eine hochwirksame systemische Belastung des gesamten Organismus. Ein tieferes Verst√§ndnis der toxikologischen Mechanismen zeigt, dass Pr√§vention und Rauchstopp keine rein individuellen Entscheidungen, sondern essenzielle Ma√ünahmen des biologischen Gesundheitsschutzes sind. Ein gesunder K√∂rper beginnt mit der Entscheidung, die t√§gliche Zufuhr dieser 7.000 Chemikalien zu beenden."
                ]
            },
            { 
                id: 6, 
                title: "Finanzieller Stress & K√∂rperliche Resilienz", 
                cat: "Mental Health", 
                time: "14 min", 
                author: "Dr. Wagner", 
                image: "https://images.unsplash.com/photo-1554224155-1696413565d3?auto=format&fit=crop&w=800", 
                desc: "Wie √∂konomische Sorgen Ihre Gesundheit beeinflussen und wie Sie Ihre psychische Widerstandskraft st√§rken.", 
                fullText: [
                    "Geldsorgen werden oft nur als psychisches oder soziales Problem wahrgenommen, stellen jedoch eine erhebliche k√∂rperliche Belastung dar. Finanzieller Stress ist h√§ufig langanhaltend, schwer kontrollierbar und emotional aufgeladen ‚Äì eine Kombination, die tief in unsere biologischen Regulationssysteme eingreift und die langfristige Gesundheit massiv beeinflussen kann.",
                    "Die Biologie der Geldsorgen: Um zu verstehen, wie finanzielle Unsicherheit wirkt, muss man die Stressreaktion betrachten. Zentral beteiligt sind das sympathische Nervensystem und die Hypothalamus-Hypophysen-Nebennieren-Achse (HPA-Achse). Bei Bedrohung sch√ºtten diese Systeme Hormone wie Adrenalin und Cortisol aus. W√§hrend dies kurzfristig die Leistungsf√§higkeit steigert, f√ºhrt das Fehlen von Erholungsphasen bei chronischem Geldstress zu einer dauerhaften hormonellen Dysregulation.",
                    "Warum finanzieller Stress besonders sch√§dlich ist: Im Gegensatz zu akuten k√∂rperlichen Gefahren wirken finanzielle Sorgen oft √ºber Jahre. Der K√∂rper bleibt in einem Zustand permanenter Alarmbereitschaft. Hinzu kommt das Gef√ºhl des Kontrollverlusts und die soziale Dimension durch Scham oder Isolation. Diese Faktoren verst√§rken die Stressreaktion und verhindern, dass der Parasympathikus ‚Äì unser System f√ºr Ruhe und Regeneration ‚Äì aktiv werden kann.",
                    "K√∂rperliche Auswirkungen und allostatische Last: Chronisch erh√∂htes Cortisol ver√§ndert den Fettstoffwechsel, erh√∂ht den Blutzucker und unterdr√ºckt das Immunsystem. Die Folge ist eine steigende 'allostatische Last' ‚Äì eine biologische Abnutzung des Organismus durch dauerhafte Stressanpassung. Dies erh√∂ht messbar das Risiko f√ºr Bluthochdruck, Arteriosklerose und chronische Entz√ºndungsprozesse, unabh√§ngig von anderen Lebensstilfaktoren.",
                    "Was bedeutet k√∂rperliche Resilienz? Resilienz ist die F√§higkeit des K√∂rpers, Belastungen zu tolerieren, flexibel zu reagieren und nach Stress wieder in das Gleichgewicht zur√ºckzukehren. Sie zeigt sich in stabilen Schlafmustern, einer schnellen Erholung nach Belastungen und einer robusten Immunfunktion. Obwohl finanzielle Stabilit√§t resilientes Verhalten erleichtert, lassen sich k√∂rperliche Schutzfaktoren auch unter schwierigen Umst√§nden gezielt st√§rken.",
                    "Schlaf und Bewegung als biologische Fundamente: Schlaf ist der st√§rkste Resilienzfaktor, da er Stresshormone reguliert und das Immunsystem st√§rkt. Schon kleine Rituale zur Reizreduktion am Abend k√∂nnen die Schlafqualit√§t verbessern. Ebenso wirkt Bewegung als nat√ºrlicher Stressregulator: K√∂rperliche Aktivit√§t senkt den Cortisolspiegel und verbessert die Insulinsensitivit√§t. Einfache Ma√ünahmen wie regelm√§√üiges Spazierengehen zeigen hier bereits deutliche Effekte auf die Stressregulation.",
                    "Ern√§hrung, Atmung und soziale Puffer: Unter Stress neigt der Mensch zu zuckerhaltigen Lebensmitteln, die jedoch Blutzuckerschwankungen und Stressreaktionen verst√§rken. Eine n√§hrstoffreiche Ern√§hrung und bewusste Atemtechniken sind direkte Schnittstellen zum Nervensystem, um den Parasympathikus zu aktivieren. Zudem wirken stabile soziale Beziehungen als biologischer Schutzfaktor, da sie die Cortisolaussch√ºttung d√§mpfen und die Herzgesundheit stabilisieren.",
                    "Fazit: Resilienz bedeutet nicht 'aushalten um jeden Preis'. K√∂rperliche Resilienz bietet keinen direkten Schutz vor finanziellen Problemen, entscheidet aber ma√ügeblich dar√ºber, wie stark diese den Organismus sch√§digen. Schlaf, Bewegung, Ern√§hrung und soziale Verbundenheit sind biologische Grundlagen, um selbst unter Druck Stabilit√§t und Handlungsf√§higkeit zu bewahren. Ein gesunder K√∂rper ist die Basis, um Herausforderungen mit Klarheit zu begegnen."
                ]
            }
        ];
        const PERSONALIZED_CONTENT = [
    { 
        id: 101, title: "Ihr individuelles Stoffwechsel-Profil", cat: "Analyse", time: "5 min", author: "VitalCore AI", match: "99% Match",
        image: "https://images.unsplash.com/photo-1576091160399-112ba8d25d1d?auto=format&fit=crop&w=800", 
        fullText: [
            "Anhand der von Ihnen √ºbermittelten biometrischen Daten (Alter, Gr√∂√üe und Gewicht) hat unser Algorithmus Ihren pr√§zisen basalen Ruheumsatz (BMR) kalkuliert. Dieser Wert repr√§sentiert die exakte Energiemenge, die Ihr Organismus ben√∂tigt, um lebenswichtige Funktionen wie Thermoregulation, Zellreparatur und kardiovaskul√§re Aktivit√§t im absoluten Ruhezustand aufrechtzuerhalten. Es ist wichtig zu verstehen, dass der BMR etwa 60-75% Ihres t√§glichen Gesamtenergieverbrauchs ausmacht. Faktoren wie die fettfreie K√∂rpermasse (LBM) spielen hierbei eine entscheidende Rolle: Je h√∂her Ihr Muskelanteil, desto effizienter arbeitet Ihr 'Motor' auch im Schlaf.",
            "Ein zentraler Aspekt Ihrer Analyse ist die 'moderate metabolische Flexibilit√§t'. In der modernen Stoffwechselforschung beschreibt dies die F√§higkeit des K√∂rpers, je nach Verf√ºgbarkeit und Bedarf nahtlos zwischen der Oxidation von Kohlenhydraten und Fetts√§uren zu wechseln. Bei vielen Menschen ist diese F√§higkeit durch st√§ndige Nahrungsverf√ºgbarkeit eingeschr√§nkt ‚Äì der K√∂rper verlernt, auf gespeichertes K√∂rperfett zuzugreifen. Ihre Daten deuten darauf hin, dass Ihr System zwar gut auf Glukose anspricht, die mitochondriale Effizienz bei der Fettverbrennung jedoch durch gezielte Reize wie Intervallfasten oder moderates Ausdauertraining weiter optimiert werden kann.",
            "Wir stellen fest, dass Ihr K√∂rper aktuell eine erh√∂hte Unterst√ºtzung bei der Stickstoffbilanz ben√∂tigt. Stickstoff ist ein essenzieller Baustein von Aminos√§uren. Eine negative Stickstoffbilanz w√ºrde bedeuten, dass Ihr K√∂rper mehr Protein abbaut, als er aufnimmt ‚Äì ein Zustand, der langfristig zu Muskelschwund (Sarkopenie) und einem verlangsamten Stoffwechsel f√ºhrt. Um die Proteinsynthese zu stimulieren und Ihre metabolische Rate stabil zu halten, empfehlen wir eine Zufuhr von 1,2 bis 1,5 Gramm Protein pro Kilogramm K√∂rpergewicht, idealerweise verteilt auf drei bis vier Mahlzeiten am Tag, um den 'Leucin-Schwellenwert' f√ºr den Muskelaufbau regelm√§√üig zu erreichen.",
            "Zus√§tzlich zeigt Ihre Analyse eine Korrelation zwischen Ihrem Aktivit√§tslevel und der Insulinsensitivit√§t. Wenn Sie Kohlenhydrate konsumieren, sch√ºttet die Bauchspeicheldr√ºse Insulin aus, um den Zucker in die Zellen zu transportieren. Bei moderater Flexibilit√§t ist es ratsam, komplexe Kohlenhydrate (Vollkorn, H√ºlsenfr√ºchte) bevorzugt nach k√∂rperlicher Aktivit√§t zu verzehren. Zu diesem Zeitpunkt ist die Glukoseaufnahme der Muskulatur am h√∂chsten, was die Belastung f√ºr Ihr hormonelles System minimiert und die Einlagerung in Fettdepots verhindert.",
            "In Ihrem pers√∂nlichen Download-Bereich finden Sie ab sofort einen detaillierten Ern√§hrungsplan, der exakt auf Ihre metabolischen Zyklen abgestimmt ist. Wir haben dort auch spezifische Mikron√§hrstoffe aufgelistet ‚Äì wie Magnesium und Alpha-Lipons√§ure ‚Äì, die nachweislich die mitochondriale Funktion unterst√ºtzen. Ziel ist es, Ihre metabolische Flexibilit√§t von 'moderat' auf 'hoch' zu steigern, um ein Maximum an t√§glicher Energie und langfristiger Zellgesundheit zu garantieren."
        ] 
    },
    { 
        id: 102, title: "Ihre biometrische Lebensplanung & Prognose", cat: "Zukunfts-Report", time: "5 min", author: "Prof. Dr. Leisner", match: "84% Match",
        image: "https://images.unsplash.com/photo-1559757175-5700dde675bc?auto=format&fit=crop&w=800", 
        fullText: [
            "Dieser umfassende Zukunfts-Report basiert auf einer biostatistischen Modellierung, die Ihre biometrischen Basisdaten mit Ihren pers√∂nlichen Angaben zur langfristigen Lebensplanung und Ihrem sozio-√∂konomischen Status verkn√ºpft. Die moderne Pr√§ventionsmedizin blickt heute weit √ºber das aktuelle Jahr hinaus: Wir nutzen pr√§diktive Algorithmen, um potenzielle gesundheitliche Engp√§sse in verschiedenen Lebensdekaden zu identifizieren. Dabei spielen epigenetische Faktoren ‚Äì also wie Ihr Lebensstil Ihre Gene 'schaltet' ‚Äì die Hauptrolle in unserer Prognose.",
            "Ein entscheidender Punkt Ihrer Analyse ist der angegebene Reproduktionswunsch. Die VitalCore-Engine gleicht diesen Wunsch mit Ihrem biologischen Zeitfenster ab. Hierbei geht es nicht nur um das chronologische Alter, sondern um die 'ovarielle Reserve' bzw. die Spermienqualit√§t, welche stark durch den BMI und das oxidative Stresslevel beeinflusst werden. Unsere Daten zeigen, dass eine Optimierung des Gewichts und eine Reduktion von Umwelttoxinen die statistische Wahrscheinlichkeit f√ºr eine komplikationslose Konzeption und Schwangerschaft signifikant erh√∂hen k√∂nnen. Wir betrachten hierbei auch die hormonelle Balance (Endokrinologie), die als Fundament f√ºr Ihre Familienplanung dient.",
            "Ein oft √ºbersehener Faktor in der Lebensplanung ist der Versicherungsstatus. Ob gesetzlich (GKV) oder privat versichert (PKV), definiert oft den Zugang zu spezialisierten Screening-Verfahren. In Ihrer Prognose haben wir ber√ºcksichtigt, welche diagnostischen Ketten ‚Äì von der genetischen Fr√ºherkennung bis hin zum hochaufl√∂senden MRT-Screening ‚Äì f√ºr Sie am effektivsten sind. Wir empfehlen Ihnen, Prophylaxe-Ma√ünahmen nicht als Kosten, sondern als strategische Investition in Ihre 'Healthspan' zu sehen. Je fr√ºher degenerative Prozesse erkannt werden, desto kosteneffizienter und schonender ist die Intervention.",
            "Dar√ºber hinaus analysiert unser System Ihre berufliche Belastung im Kontext Ihrer physischen Belastbarkeit. Ein hohes Arbeitspensum bei gleichzeitigem Schlafmangel f√ºhrt zu einer beschleunigten Verk√ºrzung der Telomere (die Schutzkappen Ihrer Chromosomen). Dies ist ein messbarer Indikator f√ºr biologisches Altern. In Ihrem Report finden Sie Strategien, wie Sie durch gezielte 'Micro-Restoration'-Phasen im Alltag diesen Prozess verlangsamen k√∂nnen, um auch in zwanzig Jahren noch die gleiche kognitive und k√∂rperliche Leistungsf√§higkeit zu besitzen wie heute.",
            "Zusammenfassend l√§sst sich sagen: Ihre Zukunft ist nicht in Stein gemei√üelt. Dieser Report dient als strategische Roadmap. Er zeigt Ihnen auf, wo Sie aktuell stehen und welche Stellschrauben (Ern√§hrung, Stressmanagement, medizinische Check-ups) das gr√∂√üte Hebelpotential f√ºr ein langes, gesundes Leben bieten. Nutzen Sie dieses Profil f√ºr zuk√ºnftige Beratungsgespr√§che mit Fach√§rzten, um eine personalisierte Gesundheitsstrategie zu etablieren, die exakt auf Ihre Lebensziele zugeschnitten ist."
        ] 
    },
    { 
        id: 103, title: "Wirtschaftsstatus & Gesundheitsrisiko", cat: "Sozio-Analyse", time: "5 min", author: "VitalCore Finance", match: "93% Match",
        image: "https://images.unsplash.com/photo-1450101499163-c8848c66ca85?auto=format&fit=crop&w=800", 
        fullText: [
            "Die bereitgestellten Informationen zu Ihrem Einkommen sowie Ihrer Schuldensituation bilden eine essenzielle S√§ule unserer Risikoanalyse. In der Sozio-Epigenetik ist l√§ngst belegt, dass finanzielle Unsicherheit einer der st√§rksten Treiber f√ºr chronischen Stress ist. Unser System nutzt Ihre Daten, um die 'allostatische Last' zu berechnen. Dieser Begriff beschreibt den kumulativen Verschlei√ü von K√∂rper und Geist, der entsteht, wenn der Organismus st√§ndig versucht, sich an belastende Umweltbedingungen anzupassen. Ein hohes Ma√ü an √∂konomischem Druck f√ºhrt zu einer dauerhaften Aktivierung der Amygdala und einer √úberlastung der Nebennieren.",
            "Der VitalCore Finance-Algorithmus hat Ihren individuellen 'Economic Stress Index' (ESI) erstellt. Ein erh√∂hter ESI korreliert in Ihrem spezifischen Profil mit einem Risiko f√ºr psychosomatische Sekund√§rbeschwerden wie Schlafst√∂rungen, Spannungskopfschmerzen oder funktionelle Magen-Darm-Probleme. Wenn das Gehirn st√§ndig mit der L√∂sung finanzieller Probleme besch√§ftigt ist, sinkt die Kapazit√§t f√ºr gesundheitsf√∂rderliche Entscheidungen (das sogenannte 'Decision Fatigue'). Dies f√ºhrt oft dazu, dass unter Stress eher zu hochkalorischer Nahrung gegriffen wird oder Sporteinheiten zugunsten von Mehrarbeit gestrichen werden.",
            "Besonders kritisch ist die Auswirkung von Schulden auf die Herz-Kreislauf-Gesundheit. Studien zeigen, dass Menschen mit hoher subjektiver Schuldenlast h√§ufiger unter Bluthochdruck und einer verminderten Herzfrequenzvariabilit√§t (HRV) leiden. Dies liegt an der permanenten Sympathikus-Aktivierung ‚Äì der K√∂rper ist im '√úberlebensmodus'. Unsere Analyse zielt darauf ab, diese Zusammenh√§nge transparent zu machen, damit Sie gezielte Gegenma√ünahmen ergreifen k√∂nnen. Stressbew√§ltigung ist in diesem Kontext keine Wellness-Ma√ünahme, sondern eine medizinische Notwendigkeit zum Schutz Ihrer Gef√§√üe.",
            "Ziel dieser sozio-√∂konomischen Analyse ist es, Ihre medizinische Vorsorge optimal mit Ihren finanziellen M√∂glichkeiten zu harmonisieren. Gesundheit darf kein Luxusgut sein. In Ihrem pers√∂nlichen Bericht finden Sie daher eine Priorisierung von Ma√ünahmen: Welche kosteng√ºnstigen oder kostenfreien Routinen (wie Atemtechniken, gezielte Bewegung im Freien oder Meal-Prepping) bieten f√ºr Sie den h√∂chsten gesundheitlichen Nutzen? Wir helfen Ihnen dabei, Ihre Ressourcen so einzusetzen, dass Ihre Gesundheit trotz √∂konomischer Herausforderungen stabil bleibt.",
            "Abschlie√üend m√∂chten wir betonen, dass k√∂rperliche Resilienz ein Puffer gegen finanziellen Stress sein kann. Ein starkes Nervensystem erm√∂glicht es Ihnen, Herausforderungen mit mehr Klarheit und weniger biologischem Verschlei√ü zu begegnen. Betrachten Sie die folgenden Empfehlungen als Werkzeuge, um Ihren 'ESI' zu senken und Ihre Lebensqualit√§t nachhaltig zu sichern. Ihr detailliertes Dossier enth√§lt zudem Tipps zum Zeitmanagement, um Raum f√ºr Regeneration zu schaffen, ohne Ihre wirtschaftliche Produktivit√§t zu gef√§hrden."
        ] 
    },
    { 
        id: 104, title: "K√∂rperbild & Optimierungsw√ºnsche", cat: "Psychosomatik", time: "5 min", author: "Dr. Stein", match: "95% Match",
        image: "https://images.unsplash.com/photo-1512621776951-a57141f2eefd?auto=format&fit=crop&w=800", 
        fullText: [
            "In Ihrem Profil haben Sie spezifische Aspekte Ihres K√∂rpers definiert, die Sie gerne durch operative Eingriffe oder therapeutische Interventionen optimieren m√∂chten. Unsere Engine hat diese W√ºnsche in Korrelation zu Ihrem aktuellen Zufriedenheitswert gesetzt, um ein umfassendes psychologisches Bild zu zeichnen. Wir analysieren dabei die sogenannte 'Body-Mind-Gap' ‚Äì die Diskrepanz zwischen Ihrer objektiven biometrischen Verfassung und Ihrer subjektiven K√∂rperwahrnehmung. In einer Welt permanenter visueller Vergleiche durch soziale Medien ist diese L√ºcke bei vielen Menschen vergr√∂√üert.",
            "Es ist klinisch erwiesen, dass √§u√üere Ver√§nderungen nur dann zu einer langfristigen Steigerung des Wohlbefindens f√ºhren, wenn sie mit einer stabilen inneren Selbstakzeptanz einhergehen. Wenn die Diskrepanz zwischen Selbstbild und Idealbild zu gro√ü ist, besteht die Gefahr, dass auch nach einer erfolgreichen Operation neue Unzufriedenheiten an anderen K√∂rperstellen entstehen (das sogenannte 'Symptom-Shifting'). Unsere Analyse zeigt, dass Ihre psychische Resilienz ein entscheidender Faktor f√ºr den Heilungsprozess und das postoperative Gl√ºcksempfinden ist. Ein gesundes K√∂rperbild ist ein dynamischer Prozess, der weit √ºber die √Ñsthetik hinausgeht.",
            "Bevor Sie sich f√ºr eine invasive Intervention entscheiden, empfehlen wir ein fundiertes kl√§rendes Gespr√§ch mit einem Experten f√ºr psychosomatische Medizin. Ziel ist es, Ihre Erwartungshaltung zu objektivieren: Was kann die Medizin leisten und wo liegen die Grenzen? Oftmals k√∂nnen bereits minimale Anpassungen im Lebensstil ‚Äì wie gezieltes Krafttraining zur Straffung oder eine Ern√§hrungsumstellung zur Verbesserung des Hautbildes ‚Äì Ergebnisse erzielen, die chirurgische Eingriffe erg√§nzen oder sogar √ºberfl√ºssig machen. Wir unterst√ºtzen Sie dabei, den sichersten und nachhaltigsten Weg f√ºr Ihre K√∂rperziele zu finden.",
            "Ein weiterer wichtiger Aspekt ist das hormonelle Milieu w√§hrend einer Ver√§nderungsphase. Stresshormone wie Cortisol k√∂nnen die Wundheilung verz√∂gern und das Risiko f√ºr Narbenbildung erh√∂hen. Daher haben wir in Ihrem Dossier Techniken zur pr√§operativen Stressreduktion vorbereitet. Wir betrachten Ihren K√∂rper als ganzheitliches System: Eine √§u√üere Optimierung sollte stets mit einer inneren Vitalisierung einhergehen. Nur wenn Ihr Stoffwechsel und Ihr Nervensystem im Gleichgewicht sind, kann Ihr K√∂rper die gew√ºnschten Ver√§nderungen optimal annehmen und integrieren.",
            "In Ihrem Dossier finden Sie eine Checkliste f√ºr Beratungsgespr√§che sowie wissenschaftliche Informationen zu den von Ihnen in Betracht gezogenen Eingriffen. Wir m√∂chten, dass Sie Ihre Entscheidungen auf Basis von Fakten und innerer Klarheit treffen. Denken Sie daran: Wahre Sch√∂nheit und Ausstrahlung entstehen an der Schnittstelle von k√∂rperlicher Fitness und mentaler Gesundheit. VitalCore begleitet Sie dabei, diese Balance zu finden und Ihre pers√∂nlichen Optimierungsw√ºnsche verantwortungsvoll umzusetzen."
        ] 
    }
];
        // 4. HELFER FUNKTIONEN
        const getGroupConfig = (groupID) => {
            const map = {
                1: { eyes: false, sound: false, info: false },
                2: { eyes: true,  sound: false, info: false },
                3: { eyes: false, sound: true,  info: false },
                4: { eyes: true,  sound: true,  info: false },
                5: { eyes: true,  sound: false, info: true  },
                6: { eyes: false, sound: true,  info: true  },
                7: { eyes: true,  sound: true,  info: true  }
            };
            return map[groupID] || map[1]; 
        };

        const playSoundFile = (audioObj) => {
            if (!audioObj) return;
            audioObj.currentTime = 0;
            const playPromise = audioObj.play();
            if (playPromise !== undefined) {
                playPromise.catch(error => console.log("Audio Error:", error));
            }
        };

        // 5. KOMPONENTEN
        const IntroScreen = ({ onStart }) => (
            <div className="min-h-screen bg-slate-900 flex items-center justify-center p-4">
                <div className="bg-white max-w-md w-full p-8 rounded-2xl shadow-2xl text-center animate-fade-in">
                    <div className="w-16 h-16 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center mx-auto mb-6">
                        <Icon path={paths.activity} className="w-8 h-8" />
                    </div>
                    <h1 className="text-2xl font-bold text-gray-900 mb-4">Willkommen</h1>
                    <p className="text-gray-600 mb-8">
                        Wichtig: Bitte stellen Sie sicher, dass Ihr Ton eingeschaltet ist!üîä<br/>
                        Klicken Sie erst dann auf "Starten", um die Webseite zu laden.
                    </p>
                    <div className="text-xs text-gray-300 mt-2 mb-6">
                        System-Check: {window.location.search.includes('t=') ? "‚úÖ Token erkannt" : "‚ùå Kein Token gefunden"}
                    </div>
                    <button onClick={onStart} className="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-4 rounded-xl shadow-lg transition-transform transform active:scale-95 text-lg">
                        Starten
                    </button>
                </div>
            </div>
        );

        const AudioTest = ({ onPassed, audioFile }) => {
    const [played, setPlayed] = useState(false);
    const [selected, setSelected] = useState(null);
    const [error, setError] = useState(false);
    const [success, setSuccess] = useState(false); // Neuer Status f√ºr Erfolg
    const audioRef = useRef(null); // Speicher f√ºr das Audio-Objekt

    const options = [
        { id: 'dog', label: 'Hundebellen' },
        { id: 'bell', label: 'Glocke' },
        { id: 'rain', label: 'Regenschauer' },
        { id: 'car', label: 'Autohupe' }
    ];

    const handlePlay = () => {
        // Falls schon ein Ton l√§uft, stoppen wir ihn erst (verhindert Echo)
        if (audioRef.current) {
            audioRef.current.pause();
            audioRef.current.currentTime = 0;
        }
        audioRef.current = new Audio(audioFile);
        audioRef.current.play().catch(e => console.error("Audio Playback failed", e));
        setPlayed(true);
    };

    const checkResult = (id) => {
        if (success) return; // Verhindert Mehrfachklicks bei Erfolg

        setSelected(id);
        if (id === 'bell') {
            // 1. TON SOFORT STOPPEN
            if (audioRef.current) {
                audioRef.current.pause();
                audioRef.current.currentTime = 0;
            }
            
            // 2. ERFOLGSMELDUNG ANZEIGEN
            setSuccess(true);
            
            // 3. VERZ√ñGERUNG (2 Sek.), dann weiter zum Blog
            setTimeout(() => {
                onPassed(); 
            }, 2000);

        } else {
            setError(true);
            setTimeout(() => { setError(false); setSelected(null); }, 2000);
        }
    };

    return (
        <div className="min-h-screen bg-slate-900 flex items-center justify-center p-4">
            <div className="bg-white max-w-md w-full p-10 rounded-[40px] shadow-2xl text-center animate-fade-in">
                
                {/* Dynamischer Titel */}
                <h2 className={`text-2xl font-black mb-6 uppercase tracking-tight transition-colors ${success ? 'text-green-600' : 'text-slate-900'}`}>
                    {success ? '‚úì Korrekt!' : 'Audio-Check'}
                </h2>

                {!success ? (
                    <>
                        <p className="text-slate-600 mb-8 text-sm leading-relaxed">
                            Um fortzufahren, m√ºssen wir sicherstellen, dass Ihr Ton funktioniert. 
                            Klicken Sie auf den Button und w√§hlen Sie aus, was Sie h√∂ren.
                        </p>

                        <button 
                            onClick={handlePlay}
                            className={`w-full py-4 mb-8 rounded-2xl font-bold flex items-center justify-center gap-2 transition-all ${played ? 'bg-slate-100 text-slate-400' : 'bg-blue-600 text-white shadow-lg active:scale-95'}`}
                        >
                            <Icon path={paths.activity} className="w-5 h-5" />
                            {played ? "Ton wird/wurde abgespielt" : "Ton abspielen"}
                        </button>

                        {played && (
                            <div className="grid grid-cols-1 gap-3 animate-fade-in">
                                {options.map(opt => (
                                    <button
                                        key={opt.id}
                                        onClick={() => checkResult(opt.id)}
                                        className={`py-3 rounded-xl border-2 font-bold transition-all ${
                                            selected === opt.id 
                                                ? (opt.id === 'bell' ? 'border-green-500 bg-green-50 text-green-700' : 'border-red-500 bg-red-50 text-red-700')
                                                : 'border-slate-100 hover:border-blue-200 text-slate-600'
                                        }`}
                                    >
                                        {opt.label}
                                    </button>
                                ))}
                            </div>
                        )}
                    </>
                ) : (
                    /* ERFOLGS-ANSICHT */
                    <div className="py-10 animate-fade-in">
                        <div className="w-20 h-20 bg-green-100 text-green-600 rounded-full flex items-center justify-center mx-auto mb-6">
                            <Icon path={paths.check} className="w-10 h-10" />
                        </div>
                        <p className="text-green-700 font-bold text-lg">Audiotest bestanden!</p>
                        <p className="text-slate-400 text-xs mt-2">Die Webseite wird geladen...</p>
                    </div>
                )}
                
                {error && <p className="text-red-500 text-xs mt-4 font-bold animate-pulse">Das war nicht richtig. Bitte versuchen Sie es erneut.</p>}
            </div>
        </div>
    );
};
        const StimulusOverlay = ({ config, variant = "banner" }) => {
    if (!config || !config.eyes) return null;
    const eyeColor = variant === 'banner' ? '#3b82f6' : '#5D4037';
    const positionClass = variant === 'form' ? 'fixed top-4 left-1/2 -translate-x-1/2' : 'absolute -top-12 left-1/2 -translate-x-1/2'; 

    return (
        <div className={`pointer-events-none z-[100] flex flex-col items-center gap-2 ${positionClass}`}>
            <div className="flex gap-4 items-center justify-center bg-white p-2 rounded-full shadow-[0_0_30px_rgba(255,255,255,1),0_10px_30px_rgba(0,0,0,0.2)] border border-slate-100">
                <RealisticEye color={eyeColor} className="w-20 h-14 animate-pulse-slow" hasLashes={true} />
                <RealisticEye color={eyeColor} className="w-20 h-14 animate-pulse-slow" hasLashes={true} />
            </div>
        </div>
    );
};

const CookieBanner = ({ group, onDecision, audioObject, onBannerLoad }) => {
    const config = getGroupConfig(group);
    useEffect(() => { 
        onBannerLoad(); 
        if (config.sound && audioObject) playSoundFile(audioObject); 
    }, []);
    
    const [details, setDetails] = useState(false);

    return (
        <div className="fixed bottom-0 left-0 right-0 z-50 p-4 md:p-8 bg-white shadow-[0_-20px_50px_rgba(0,0,0,0.15)] border-t-4 border-blue-600 animate-slide-up rounded-t-[40px]">
            <div className="max-w-7xl mx-auto relative pt-8">
                
{/* 1. SCHWEBENDER TEIL: Augen und Info-Box stabil NEBENEINANDER */}
<div className="absolute -top-44 left-0 right-0 flex justify-center items-center pointer-events-none">
    <div className="flex items-center gap-8 pointer-events-auto">
        
        {/* Augen-Container: Dieser feste Rahmen zwingt die Augen an ihre Position links */}
        <div className="w-48 h-20 flex items-center justify-center relative">
            <div className="scale-110">
                <StimulusOverlay config={config} variant="banner" />
            </div>
        </div>

        {/* Die Info-Box */}
        <div className={`max-w-md p-6 rounded-[30px] shadow-2xl border-2 animate-fade-in ${config.info ? 'bg-red-50/95 border-red-200' : 'bg-blue-50/95 border-blue-200'}`}>
            <div className={`flex items-center gap-2 font-black mb-2 uppercase tracking-tighter text-[10px] ${config.info ? 'text-red-600' : 'text-blue-600'}`}>
                <Icon path={config.info ? paths.shield : paths.activity} className="w-4 h-4"/> 
                {config.info ? 'HINWEIS ZUR DATENERFASSUNG' : 'HINWEIS ZU VITALCORE'}
            </div>
            <p className={`text-[10px] leading-relaxed ${config.info ? 'text-red-800/90' : 'text-blue-800/90'}`}>
                {config.info 
                    ? "Alles, was Sie auf dieser Seite tun oder eingeben, wird l√ºckenlos aufgezeichnet. Ihre Informationen werden sofort ausgewertet, um ein pers√∂nliches Bild Ihrer Person und Ihres Privatlebens zu erstellen. Einmal erfasst, bleiben diese Informationen dauerhaft gespeichert."
                    : "VitalCore ist eine Plattform f√ºr medizinisches Wissen und Gesundheitsanalysen. In den verschiedenen Bereichen des Portals k√∂nnen Sie personalisierte Inhalte erhalten und die verf√ºgbaren Funktionen nutzen."
                }
            </p>
        </div>

    </div>
</div>               {/* 2. BANNER-INHALT (Das wei√üe Feld unten) */}
                <div className="flex flex-col lg:flex-row gap-8 items-stretch lg:items-center">
                    <div className="flex-1 space-y-2">
                        <h3 className="text-xl font-black text-slate-900 tracking-tight">Privatsph√§re-Einstellungen</h3>
                        <p className="text-sm text-slate-500 leading-relaxed max-w-2xl">
                            Wir nutzen Cookies und Tracking-Technologien, um Ihr Nutzererlebnis zu personalisieren und unser medizinisches Informationsangebot zu verbessern. 
                            {details && (
                                <span className="block mt-3 p-3 bg-slate-50 rounded-xl border border-slate-100 text-xs text-slate-400 animate-fade-in">
                                    Dabei werden pseudonymisierte Daten an Analyse-Partner √ºbertragen. Dies erm√∂glicht eine algorithmische Anpassung der Inhalte an Ihr Gesundheitsprofil.
                                </span>
                            )}
                        </p>
                        <button onClick={() => setDetails(!details)} className="text-xs text-blue-600 font-bold uppercase tracking-widest hover:text-blue-800 transition-colors">
                            {details ? "‚àí Weniger Informationen" : "+ Mehr Informationen"}
                        </button>
                    </div>

                    {/* Die Buttons */}
                    <div className="flex flex-col gap-3 shrink-0 min-w-[200px] justify-center">
                        <button onClick={() => onDecision('accept_all')} className="px-8 py-4 bg-blue-600 hover:bg-blue-700 text-white font-black rounded-2xl shadow-lg transition-all transform active:scale-95 text-sm uppercase">
                            Alle akzeptieren
                        </button>
                        <button onClick={() => onDecision('reject_all')} className="px-8 py-3 bg-white hover:bg-slate-50 text-slate-400 font-bold border border-slate-200 rounded-2xl transition-colors text-xs uppercase">
                            Nur Notwendige
                        </button>
                    </div>
                </div>
            </div>
        </div>
    );
};
       const BlogPage = ({ onAction, mode = 'initial', cookieChoice }) => {
            const [selectedArticle, setSelectedArticle] = useState(null);
            const [categoryFilter, setCategoryFilter] = useState("Alle Beitr√§ge");
            const [showLoginModal, setShowLoginModal] = useState(false);
            const [likes, setLikes] = useState({});
            const [articlesToDisplay, setArticlesToDisplay] = useState([]);

            const requiredTime = mode === 'initial' ? MIN_BROWSING_TIME_1 : MIN_BROWSING_TIME_2;
            const [timeLeft, setTimeLeft] = useState(requiredTime);

            useEffect(() => {
                if (mode === 'initial') {
                    setArticlesToDisplay(BLOG_CONTENT);
                } else {
                    const oldContentShuffled = [...BLOG_CONTENT].sort(() => 0.5 - Math.random());
                    setArticlesToDisplay([...PERSONALIZED_CONTENT, ...oldContentShuffled]);
                }
            }, [mode]);

            useEffect(() => {
                if (timeLeft <= 0) return;
                const timer = setInterval(() => setTimeLeft(prev => prev - 1), 1000);
                return () => clearInterval(timer);
            }, [timeLeft]);

            const filteredArticles = categoryFilter === "Alle Beitr√§ge" 
                ? articlesToDisplay 
                : articlesToDisplay.filter(a => a.cat === categoryFilter);

            const categories = ["Alle Beitr√§ge", "Forschung", "Ern√§hrung", "Fitness", "Mental Health", "Pr√§vention"];
            const toggleLike = (e, id) => { e.stopPropagation(); setLikes(prev => ({...prev, [id]: !prev[id]})); };

            const HeaderTitle = () => (
                <div onClick={() => {setCategoryFilter("Alle Beitr√§ge"); setSelectedArticle(null);}} className="flex items-center gap-2 cursor-pointer hover:opacity-80 transition-opacity">
                    <div className="p-1.5 bg-green-100 rounded text-green-600"><Icon path={paths.leaf} className="w-6 h-6" /></div>
                    <span className="text-xl font-bold tracking-tight text-slate-800">
                        Vital<span className="text-green-600">Core</span>
                        {mode === 'personalized' && <span className="ml-2 text-xs bg-green-600 text-white px-2 py-0.5 rounded uppercase">F√ºr Sie</span>}
                    </span>
                </div>
            );

            const ActionButton = ({inHeader}) => {
                if (mode === 'initial') {
                    if (timeLeft > 0) {
                        return (
                            <button disabled className={`bg-slate-300 text-slate-500 rounded-full font-medium cursor-not-allowed flex items-center gap-2 ${inHeader ? 'px-5 py-2 text-sm' : 'w-full py-3 justify-center'}`}>
                                <Icon path={paths.clock} className="w-4 h-4 animate-pulse" /> Gesundheitsprofil erstellen in {timeLeft}s
                            </button>
                        );
                    }
                    if (cookieChoice === null) {
                        return (
                            <button disabled className={`bg-orange-100 text-orange-600 border border-orange-200 rounded-full font-bold cursor-not-allowed flex items-center gap-2 ${inHeader ? 'px-5 py-2 text-sm' : 'w-full py-3 justify-center'}`}>
                                Bitte treffen Sie eine Cookie-Wahl
                            </button>
                        );
                    }
                    return (
                        <button onClick={onAction} className={`bg-slate-900 text-white rounded-full font-medium hover:bg-slate-800 transition-colors shadow-lg animate-fade-in ${inHeader ? 'px-5 py-2 text-sm' : 'w-full py-3'}`}>
                            Gesundheitsprofil erstellen
                        </button>
                    );
                } else {
                    if (timeLeft > 0) return (<div className={`bg-green-100 text-green-800 rounded-full text-xs font-bold animate-pulse ${inHeader ? 'px-4 py-2' : 'w-full py-3 text-center'}`}>Personalisierte Ansicht aktiv ({timeLeft}s)...</div>);
                    return (
                        <button onClick={onAction} className={`bg-green-600 text-white rounded-full font-bold hover:bg-green-700 transition-colors shadow-lg animate-fade-in ${inHeader ? 'px-6 py-2 text-sm' : 'w-full py-3'}`}>
                            Weiter zum Fragebogen
                        </button>
                    );
                }
            };

            if (selectedArticle) {
                return (
                    <div className="min-h-screen flex flex-col font-sans text-slate-800 bg-white animate-fade-in">
                        <nav className="bg-white border-b sticky top-0 z-20 shadow-sm px-4 h-16 flex items-center justify-between">
                            <HeaderTitle />
                            <div className="flex gap-4 items-center">
                                <button onClick={() => setSelectedArticle(null)} className="text-sm font-medium text-slate-500 hover:text-green-600 flex items-center gap-1">
                                    <Icon path={paths.arrowLeft} className="w-4 h-4" /> Zur√ºck
                                </button>
                                <ActionButton inHeader={true} />
                            </div>
                        </nav>
                        <article className="max-w-3xl mx-auto px-4 py-12">
                            <div className="w-full h-80 rounded-2xl overflow-hidden mb-8 shadow-md">
                                <img src={selectedArticle.image} className="w-full h-full object-cover" />
                            </div>
                            <div className="flex items-center gap-3 text-sm font-bold text-green-600 uppercase tracking-wider mb-3">
                                {selectedArticle.cat} ‚Ä¢ {selectedArticle.date || "Aktuell"}
                            </div>
                            <h1 className="text-4xl font-extrabold text-slate-900 mb-6 leading-tight">{selectedArticle.title}</h1>
                            <div className="flex items-center gap-3 text-slate-500 mb-8 pb-8 border-b">
                                <span className="font-medium">{selectedArticle.author}</span>
                                <span>‚Ä¢</span>
                                <span className="flex items-center gap-1"><Icon path={paths.clock} className="w-4 h-4" /> {selectedArticle.time} Lesezeit</span>
                            </div>
                            <div className="prose prose-lg text-slate-700 leading-relaxed space-y-6">
                                {selectedArticle.fullText.map((p, i) => <p key={i}>{p}</p>)}
                            </div>
                        </article>
                    </div>
                );
            }

            return (
                <div className="min-h-screen flex flex-col font-sans text-slate-800 bg-slate-50 relative">
                    <nav className="bg-white border-b sticky top-0 z-20 shadow-sm">
                        <div className="max-w-6xl mx-auto px-4 h-16 flex items-center justify-between">
                            <HeaderTitle />
                            <div className="hidden md:flex gap-1 mx-4">
                                {categories.map(item => (
                                    <button key={item} onClick={() => setCategoryFilter(item)} className={`whitespace-nowrap px-3 py-2 text-sm font-medium rounded-full transition-colors ${categoryFilter === item ? 'bg-slate-900 text-white' : 'text-slate-500 hover:bg-slate-100'}`}>
                                        {item}
                                    </button>
                                ))}
                            </div>
                            <div className="flex gap-4 items-center shrink-0">
                                <button className="p-2 text-slate-400 hover:text-slate-600" onClick={() => setShowLoginModal(true)}>
                                    <Icon path={paths.search} className="w-5 h-5" />
                                </button>
                                <ActionButton inHeader={true} />
                            </div>
                        </div>
                    </nav>

                    <main className="flex-grow max-w-6xl mx-auto px-4 py-8 w-full">
                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                            {filteredArticles.map(art => (
                                <article key={art.id} onClick={() => setSelectedArticle(art)} className="bg-white rounded-2xl border border-slate-100 shadow-sm hover:shadow-lg transition-all cursor-pointer overflow-hidden group flex flex-col h-full relative">
                                    {art.match && <div className="absolute top-3 left-3 z-10 bg-green-500 text-white text-xs font-bold px-2 py-1 rounded shadow-lg">{art.match}</div>}
                                    <div className="h-48 overflow-hidden relative">
                                        <img src={art.image} className="w-full h-full object-cover group-hover:scale-105 transition-transform duration-500" />
                                        <div className="absolute top-3 right-3">
                                            <button onClick={(e) => toggleLike(e, art.id)} className={`p-2 rounded-full backdrop-blur-md transition-colors ${likes[art.id] ? 'bg-red-50 text-red-500' : 'bg-black/30 text-white'}`}>
                                                <Icon path={likes[art.id] ? paths.heartFilled : paths.heart} className="w-5 h-5" />
                                            </button>
                                        </div>
                                    </div>
                                    <div className="p-5 flex-1 flex flex-col">
                                        <div className="text-[10px] font-black text-green-600 uppercase tracking-widest mb-2">{art.cat}</div>
                                        <h3 className="text-lg font-bold text-slate-900 mb-2 group-hover:text-green-600 transition-colors leading-tight">{art.title}</h3>
                                        <p className="text-slate-600 text-sm line-clamp-3 mb-4 flex-1">{art.desc}</p>
                                        <div className="flex items-center justify-between pt-4 border-t border-slate-100">
                                            <span className="text-xs font-bold text-slate-500 uppercase">{art.author}</span>
                                            <span className="text-[10px] text-slate-400">{art.time}</span>
                                        </div>
                                    </div>
                                </article>
                            ))}
                        </div>
                    </main>

                    {showLoginModal && (
                        <div className="fixed inset-0 bg-black/50 z-[100] flex items-center justify-center p-4" onClick={() => setShowLoginModal(false)}>
                            <div className="bg-white rounded-xl p-8 max-w-sm w-full text-center" onClick={(e) => e.stopPropagation()}>
                                <div className="w-12 h-12 bg-red-100 text-red-500 rounded-full flex items-center justify-center mx-auto mb-4">
                                    <Icon path={paths.shield} className="w-6 h-6" />
                                </div>
                                <h3 className="text-xl font-bold mb-2">Zugriff verweigert</h3>
                                <p className="text-gray-600 mb-6">Dieser Bereich ist f√ºr Teilnehmer der Studie reserviert.</p>
                                <button onClick={() => setShowLoginModal(false)} className="w-full bg-gray-900 text-white font-bold py-2 rounded-lg">Verstanden</button>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        // 1. HELFER-KOMPONENTEN (JETZT AUSSERHALB - BEHEBT DEN CURSOR-FEHLER)
const NoAnswer = ({ field, noAnswers, setNoAnswers }) => (
    <label className="flex items-center gap-2 mt-2 cursor-pointer w-fit group">
        <input 
            type="checkbox" 
            checked={!!noAnswers[field]} 
            onChange={() => setNoAnswers(prev => ({ ...prev, [field]: !prev[field] }))} 
            className="w-3.5 h-3.5 rounded border-slate-300 text-blue-600 focus:ring-blue-500" 
        />
        <span className="text-[9px] text-slate-400 group-hover:text-slate-600 uppercase tracking-widest font-bold transition-colors">Keine Angabe</span>
    </label>
);

const JaNeinInput = ({ label, field, placeholder, formData, setFormData, noAnswers, setNoAnswers, interact }) => {
    const handleTextChange = (e) => {
        interact();
        setFormData(prev => ({ ...prev, [e.target.name]: e.target.value }));
    };

    return (
        <div className={noAnswers[field] ? 'opacity-30' : ''}>
            <label className="text-sm font-bold text-slate-700 block mb-3">{label}</label>
            <div className="flex gap-4 mb-3">
                {['ja', 'nein'].map(opt => (
                    <button 
                        key={opt} 
                        type="button" 
                        disabled={noAnswers[field]} 
                        onClick={() => { interact(); setFormData(prev => ({...prev, [field]: opt})); }} 
                        className={`px-6 py-2 rounded-full text-xs font-black border-2 transition-all ${formData[field] === opt ? 'bg-slate-900 border-slate-900 text-white' : 'bg-transparent border-slate-200 text-slate-400'}`}
                    >
                        {opt.toUpperCase()}
                    </button>
                ))}
            </div>
            {formData[field] === 'ja' && !noAnswers[field] && (
                <textarea 
                    name={`${field}Details`} 
                    value={formData[`${field}Details`] || ''} 
                    onChange={handleTextChange} 
                    placeholder={placeholder} 
                    className="w-full p-4 bg-slate-50 border border-slate-100 rounded-2xl text-xs outline-none focus:bg-white h-20 animate-fade-in" 
                />
            )}
            <NoAnswer field={field} noAnswers={noAnswers} setNoAnswers={setNoAnswers} />
        </div>
    );
};

// 2. DIE VOLLST√ÑNDIGE REGISTRATION FORM
const RegistrationForm = ({ onSubmit, group, audioObject }) => {
    const [formData, setFormData] = useState({ 
        age: '', gender: '', height: '', weight: '', insurance: '',
        dietStyle: [], dietHistory: '', tobacco: '', tobaccoDetails: '',
        alcohol: '', alcoholDetails: '', drugs: '', drugsDetails: '',
        sportFreq: '', sportType: '', bodySatisfaction: 5, 
        bodyChangeGoals: '', bodyChangeDetails: '',
        mentalHealth: '', mentalHealthDetails: '',
        sexOrientation: '', reproduction: '', stis: '', stisDetails: '',
        income: '', debts: '', debtsDetails: ''
    });

    const [noAnswers, setNoAnswers] = useState({});
    const [interactionStarted, setInteractionStarted] = useState(false);
    const [timeLeft, setTimeLeft] = useState(MIN_REGISTRATION_TIME);
    
    useEffect(() => { 
        const timer = setInterval(() => setTimeLeft(t => t > 0 ? t - 1 : 0), 1000); 
        return () => clearInterval(timer); 
    }, []);

    const config = getGroupConfig(group);
    const interact = () => { 
        if (!interactionStarted) { 
            setInteractionStarted(true); 
            if (config.sound && audioObject) audioObject.play().catch(()=>{}); 
        } 
    };

    const handleChange = (e) => { 
        interact(); 
        const { name, value } = e.target;
        const val = (name === 'age' || name === 'height' || name === 'weight') ? value.replace(/[^0-9]/g, '') : value;
        setFormData(prev => ({...prev, [name]: val}));
    };

    const isFormComplete = () => {
        const check = (f) => noAnswers[f] || (formData[f] !== '' && formData[f] !== undefined && (Array.isArray(formData[f]) ? formData[f].length > 0 : true));
        const required = ['age', 'gender', 'height', 'weight', 'insurance', 'dietStyle', 'dietHistory', 'sportFreq', 'tobacco', 'alcohol', 'drugs', 'bodySatisfaction', 'bodyChangeGoals', 'mentalHealth', 'sexOrientation', 'reproduction', 'stis', 'income', 'debts'];
        return required.every(f => check(f));
    };

    return (
    <div className="min-h-screen bg-slate-100 py-12 px-4 relative pt-40 text-slate-900">
        {/* Augen und Box erscheinen erst, wenn interactionStarted auf true springt */}
        {interactionStarted && (
            <React.Fragment>
                <StimulusOverlay config={config} variant="form" />
                
                <div className="fixed top-[155px] left-1/2 -translate-x-1/2 w-[95%] max-w-xl z-[50] animate-fade-in pointer-events-none">
                    <div className={`backdrop-blur-sm border-2 p-4 rounded-[24px] shadow-xl shadow-black/5 ${config.info ? 'bg-red-50/95 border-red-200' : 'bg-blue-50/95 border-blue-200'}`}>
                        <div className={`flex items-center gap-2 font-black mb-1 uppercase tracking-tighter text-[10px] ${config.info ? 'text-red-600' : 'text-blue-600'}`}>
                            <Icon path={config.info ? paths.shield : paths.activity} className="w-4 h-4"/> 
                            {config.info ? 'HINWEIS ZUR DATENERFASSUNG' : 'HINWEIS ZU VITALCORE'}
                        </div>
                        <p className={`text-[9px] leading-relaxed ${config.info ? 'text-red-800/90' : 'text-blue-800/90'}`}>
                            {config.info 
                                ? "Alles, was Sie auf dieser Seite tun oder eingeben, wird l√ºckenlos aufgezeichnet. Ihre Informationen werden sofort ausgewertet, um ein pers√∂nliches Bild Ihrer Person und Ihres Privatlebens zu erstellen. Einmal erfasst, bleiben diese Informationen dauerhaft gespeichert."
                                : "VitalCore ist eine Plattform f√ºr medizinisches Wissen und Gesundheitsanalysen. In den verschiedenen Bereichen des Portals k√∂nnen Sie personalisierte Inhalte erhalten und die verf√ºgbaren Funktionen nutzen."
                            }
                        </p>
                    </div>
                </div>
            </React.Fragment>
        )}
            
            <div className="max-w-2xl mx-auto bg-white shadow-2xl rounded-[40px] overflow-hidden border border-slate-200 relative z-10">
                <header className="bg-slate-900 p-10 text-white text-center">
                    <h2 className="text-lg font-light tracking-[0.2em] uppercase">Systembiologisches Gesundheitsprofil</h2>
                    <span className="text-[10px] text-blue-400 font-bold uppercase mt-2 block">Clinical Data Access</span>
                </header>

                <form onSubmit={(e) => {e.preventDefault(); if(isFormComplete()) onSubmit(formData);}} className="p-8 md:p-12 space-y-16">
                    
                    <section className="space-y-8">
                        <h3 className="text-[11px] font-black uppercase tracking-widest text-blue-600 mb-6 border-b pb-2">Modul 01: Biometrische Parameter</h3>
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
                            <div className={noAnswers.age ? 'opacity-30' : ''}>
                                <label className="text-sm font-bold block mb-2">Wie alt sind Sie?</label>
                                <input type="text" name="age" disabled={noAnswers.age} value={formData.age} onChange={handleChange} className="w-full py-2 border-b border-slate-200 outline-none bg-transparent" />
                                <NoAnswer field="age" noAnswers={noAnswers} setNoAnswers={setNoAnswers} />
                            </div>
                            <div className={noAnswers.gender ? 'opacity-30' : ''}>
                                <label className="text-sm font-bold block mb-2">Welchem Geschlecht f√ºhlen Sie sich zugeh√∂rig?</label>
                                <select name="gender" disabled={noAnswers.gender} value={formData.gender} onChange={handleChange} className="w-full py-2 border-b border-slate-200 outline-none bg-transparent text-sm">
                                    <option value="">W√§hlen...</option><option value="m">M√§nnlich</option><option value="w">Weiblich</option><option value="d">Divers</option>
                                </select>
                                <NoAnswer field="gender" noAnswers={noAnswers} setNoAnswers={setNoAnswers} />
                            </div>
                        </div>
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
                            <div className={noAnswers.height ? 'opacity-30' : ''}>
                                <label className="text-sm font-bold block mb-2">Ihre K√∂rpergr√∂√üe (cm)?</label>
                                <input type="text" name="height" disabled={noAnswers.height} value={formData.height} onChange={handleChange} className="w-full py-2 border-b border-slate-200 outline-none bg-transparent" />
                                <NoAnswer field="height" noAnswers={noAnswers} setNoAnswers={setNoAnswers} />
                            </div>
                            <div className={noAnswers.weight ? 'opacity-30' : ''}>
                                <label className="text-sm font-bold block mb-2">Ihr K√∂rpergewicht (kg)?</label>
                                <input type="text" name="weight" disabled={noAnswers.weight} value={formData.weight} onChange={handleChange} className="w-full py-2 border-b border-slate-200 outline-none bg-transparent" />
                                <NoAnswer field="weight" noAnswers={noAnswers} setNoAnswers={setNoAnswers} />
                            </div>
                        </div>
                        <div className={noAnswers.insurance ? 'opacity-30' : ''}>
                            <label className="text-sm font-bold block mb-2">Wie sind Sie versichert?</label>
                            <select name="insurance" disabled={noAnswers.insurance} value={formData.insurance} onChange={handleChange} className="w-full py-2 border-b border-slate-200 outline-none bg-transparent text-sm">
                                <option value="">W√§hlen...</option><option value="gkv">Gesetzlich</option><option value="pkv">Privat</option><option value="andere">Andere</option>
                            </select>
                            <NoAnswer field="insurance" noAnswers={noAnswers} setNoAnswers={setNoAnswers} />
                        </div>
                    </section>

                    <section className="space-y-8">
                        <h3 className="text-[11px] font-black uppercase tracking-widest text-blue-600 mb-6 border-b pb-2">Modul 02: Metabolischer Lebensstil</h3>
                        <div className={noAnswers.dietStyle ? 'opacity-30' : ''}>
                            <label className="text-sm font-bold block mb-4">Welche Ern√§hrungsform(en) praktizieren Sie aktuell?</label>
                            <div className="flex flex-wrap gap-2">
                                {['Omnivor', 'Vegetarisch', 'Vegan', 'Keto', 'Fasten', 'Intervall'].map(diet => (
                                    <button key={diet} type="button" disabled={noAnswers.dietStyle} onClick={() => { interact(); const next = formData.dietStyle.includes(diet) ? formData.dietStyle.filter(d => d !== diet) : [...formData.dietStyle, diet]; setFormData(prev => ({...prev, dietStyle: next})); }} className={`px-4 py-2 rounded-full text-xs font-bold border-2 transition-all ${formData.dietStyle.includes(diet) ? 'bg-blue-600 border-blue-600 text-white shadow-md' : 'border-slate-200 text-slate-400'}`}>
                                        {diet}
                                    </button>
                                ))}
                            </div>
                            <NoAnswer field="dietStyle" noAnswers={noAnswers} setNoAnswers={setNoAnswers} />
                        </div>
                        <div className={noAnswers.dietHistory ? 'opacity-30' : ''}>
                             <label className="text-sm font-bold block mb-2">Haben Sie in der Vergangenheit Di√§ten zur Gewichtsreduktion durchgef√ºhrt?</label>
                             <textarea name="dietHistory" disabled={noAnswers.dietHistory} value={formData.dietHistory} onChange={handleChange} placeholder="" className="w-full p-4 bg-slate-50 border border-slate-100 rounded-lg outline-none h-20" />
                             <NoAnswer field="dietHistory" noAnswers={noAnswers} setNoAnswers={setNoAnswers} />
                        </div>
                    </section>

                    <section className="space-y-12">
                        <h3 className="text-[11px] font-black uppercase tracking-widest text-blue-600 mb-6 border-b pb-2">Modul 03-04: Lebensstil & Toxikologie</h3>
                        <div className={noAnswers.sportFreq ? 'opacity-30' : ''}>
                            <label className="text-sm font-bold block mb-2">Wie h√§ufig treiben Sie Sport?</label>
                            <select name="sportFreq" disabled={noAnswers.sportFreq} value={formData.sportFreq} onChange={handleChange} className="w-full py-2 border-b border-slate-200 outline-none bg-transparent text-sm">
                                <option value="">W√§hlen...</option><option value="t√§glich">T√§glich</option><option value="oft">2-4 mal pro Woche</option><option value="selten">1 mal pro Woche</option><option value="nie">Seltener / Nie</option>
                            </select>
                            {formData.sportFreq !== 'nie' && formData.sportFreq !== '' && !noAnswers.sportFreq && (
                                <div className="mt-4 animate-fade-in">
                                    <label className="text-[10px] font-bold text-slate-400 uppercase block mb-2">Welche Sportarten √ºben Sie aus?</label>
                                    <input type="text" name="sportType" value={formData.sportType} onChange={handleChange} placeholder="" className="w-full py-2 border-b border-slate-200 outline-none bg-transparent text-sm" />
                                </div>
                            )}
                            <NoAnswer field="sportFreq" noAnswers={noAnswers} setNoAnswers={setNoAnswers} />
                        </div>
                        <JaNeinInput label="Konsumieren Sie Tabak- oder Nikotinprodukte?" field="tobacco" placeholder="Welche Produkte und wie h√§ufig?" formData={formData} setFormData={setFormData} noAnswers={noAnswers} setNoAnswers={setNoAnswers} interact={interact} />
                        <JaNeinInput label="Konsumieren Sie regelm√§√üig alkoholische Getr√§nke?" field="alcohol" placeholder="Welche Getr√§nke und wie h√§ufig?" formData={formData} setFormData={setFormData} noAnswers={noAnswers} setNoAnswers={setNoAnswers} interact={interact} />
                        <JaNeinInput label="Nutzen Sie illegale Substanzen (z.B. Cannabis, Kokain)?" field="drugs" placeholder="Welche Substanzen und wie h√§ufig?" formData={formData} setFormData={setFormData} noAnswers={noAnswers} setNoAnswers={setNoAnswers} interact={interact} />
                    </section>

                    <section className="space-y-12">
    <h3 className="text-[11px] font-black uppercase tracking-widest text-blue-600 mb-6 border-b pb-2">
        Modul 05: Psychosomatische Selbstwahrnehmung
    </h3>
    
    <div className={noAnswers.bodySatisfaction ? 'opacity-30' : ''}>
        <label className="text-sm font-bold block mb-1">
            Wie zufrieden sind Sie mit Ihrem aktuellen K√∂rperzustand (1-10)?
        </label>
        
        {/* Der Slider */}
        <input 
            type="range" 
            name="bodySatisfaction" 
            min="1" 
            max="10" 
            disabled={noAnswers.bodySatisfaction} 
            value={formData.bodySatisfaction} 
            onChange={handleChange} 
            className="w-full accent-blue-600 cursor-pointer" 
        />
        
        {/* Die Zahlenskala von 1 bis 10 */}
        <div className="flex justify-between px-1 mt-2 text-[10px] text-slate-400 font-bold select-none">
            {[...Array(10)].map((_, i) => {
                const val = i + 1;
                const isActive = formData.bodySatisfaction == val && !noAnswers.bodySatisfaction;
                return (
                    <span 
                        key={val} 
                        className={`transition-all duration-200 ${isActive ? 'text-blue-600 scale-150' : ''}`}
                    >
                        {val}
                    </span>
                );
            })}
        </div>
        
        <NoAnswer field="bodySatisfaction" noAnswers={noAnswers} setNoAnswers={setNoAnswers} />
    </div>

    <JaNeinInput 
        label="Gibt es spezifische Aspekte an Ihrem K√∂rper, die Sie operativ √§ndern m√∂chten?" 
        field="bodyChangeGoals" 
        placeholder="Welche Eingriffe ziehen Sie in Erw√§gung?" 
        formData={formData} 
        setFormData={setFormData} 
        noAnswers={noAnswers} 
        setNoAnswers={setNoAnswers} 
        interact={interact} 
    />
    
    <JaNeinInput 
        label="Bestehen psychische Vorbelastungen oder befinden Sie sich in Behandlung?" 
        field="mentalHealth" 
        placeholder="Diagnosen oder Behandlungen?" 
        formData={formData} 
        setFormData={setFormData} 
        noAnswers={noAnswers} 
        setNoAnswers={setNoAnswers} 
        interact={interact} 
    />
</section>

                    <section className="space-y-12">
                        <h3 className="text-[11px] font-black uppercase tracking-widest text-blue-600 mb-6 border-b pb-2">Modul 06: Reproduktive Analyse</h3>
                        <div className={noAnswers.sexOrientation ? 'opacity-30' : ''}>
                            <label className="text-sm font-bold block mb-2">Was ist Ihre sexuelle Orientierung?</label>
                            <select name="sexOrientation" disabled={noAnswers.sexOrientation} value={formData.sexOrientation} onChange={handleChange} className="w-full py-2 border-b border-slate-200 outline-none bg-transparent text-sm">
                                <option value="">W√§hlen...</option><option value="hetero">Heterosexuell</option><option value="homo">Homosexuell</option><option value="bi">Bisexuell</option><option value="andere">Andere</option>
                            </select>
                            <NoAnswer field="sexOrientation" noAnswers={noAnswers} setNoAnswers={setNoAnswers} />
                        </div>
                        <div className={noAnswers.reproduction ? 'opacity-30' : ''}>
                            <label className="text-sm font-bold block mb-2">Besteht bei Ihnen aktuell ein Reproduktionswunsch (Kinderwunsch)?</label>
                            <select name="reproduction" disabled={noAnswers.reproduction} value={formData.reproduction} onChange={handleChange} className="w-full py-2 border-b border-slate-200 outline-none bg-transparent text-sm">
                                <option value="">W√§hlen...</option><option value="ja">Ja</option><option value="nein">Nein</option><option value="vielleicht">Vielleicht</option>
                            </select>
                            <NoAnswer field="reproduction" noAnswers={noAnswers} setNoAnswers={setNoAnswers} />
                        </div>
                        <JaNeinInput label="Sind Ihnen aktuelle oder vergangene Geschlechtskrankheiten bekannt?" field="stis" placeholder="Historie der Infektionen..." formData={formData} setFormData={setFormData} noAnswers={noAnswers} setNoAnswers={setNoAnswers} interact={interact} />
                    </section>

                    <section className="space-y-12">
                        <h3 className="text-[11px] font-black uppercase tracking-widest text-blue-600 mb-6 border-b pb-2">Modul 07: Sozio-√ñkonomischer Status</h3>
                        <div className={noAnswers.income ? 'opacity-30' : ''}>
                            <label className="text-sm font-bold block mb-2">Wie hoch ist ihr monatliches Netto-Einkommen?</label>
                            <select name="income" disabled={noAnswers.income} value={formData.income} onChange={handleChange} className="w-full py-2 border-b border-slate-200 outline-none bg-transparent text-sm">
                                <option value="">W√§hlen...</option><option value="1">Bis 1.500 ‚Ç¨</option><option value="2">1.500 ‚Ç¨ - 3.500 ‚Ç¨</option><option value="3">3.500 ‚Ç¨ - 5.000 ‚Ç¨</option><option value="4">√úber 5.000 ‚Ç¨</option>
                            </select>
                            <NoAnswer field="income" noAnswers={noAnswers} setNoAnswers={setNoAnswers} />
                        </div>
                        <JaNeinInput label="Bestehen finanzielle Schulden?" field="debts" placeholder="Art oder ungef√§hre H√∂he der Schulden?" formData={formData} setFormData={setFormData} noAnswers={noAnswers} setNoAnswers={setNoAnswers} interact={interact} />
                    </section>

                    <button type="submit" disabled={timeLeft > 0 || !isFormComplete()} className={`w-full py-6 font-black text-xs uppercase tracking-[0.5em] rounded-3xl transition-all ${timeLeft > 0 || !isFormComplete() ? 'bg-slate-100 text-slate-300 cursor-not-allowed shadow-none' : 'bg-blue-600 text-white hover:bg-blue-700 shadow-2xl active:scale-[0.98]'}`}>
                        {!isFormComplete() ? 'DATENSATZ UNVOLLST√ÑNDIG' : (timeLeft > 0 ? `VALIDIERUNG L√ÑUFT (${timeLeft}S)` : 'GESUNDHEITSPROFIL FINALISIEREN')}
                    </button>
                </form>
            </div>
        </div>
    );
};

        const LoadingScreen = ({ onFinished }) => {
            useEffect(() => { const timer = setTimeout(onFinished, 3000); return () => clearTimeout(timer); }, []);
            return (<div className="min-h-screen bg-slate-900 flex flex-col items-center justify-center p-4 text-white"><div className="w-20 h-20 border-4 border-blue-500 border-t-transparent rounded-full animate-spin-slow mb-8"></div><h2 className="text-2xl font-bold mb-2">Algorithmus analysiert Profil...</h2><p className="text-slate-400">Suche passende Inhalte f√ºr Sie.</p></div>);
        };

        const EndScreen = ({ data, sessionToken }) => {
            const [targetUrl, setTargetUrl] = useState("");
            const fullDataString = JSON.stringify(data);
            useEffect(() => { 
                const currentGroup = data.groupID; 
                if (sessionToken && currentGroup) { 
                    const finalUrl = SOSCI_BASE_URL + "?i=" + sessionToken + "&IV02_01=" + currentGroup + "&g=" + currentGroup + "&mydata=" + encodeURIComponent(fullDataString);
                    setTargetUrl(finalUrl); 
                } 
            }, [sessionToken, fullDataString, data.groupID]);

            return (
                <div className="min-h-screen bg-slate-900 flex flex-col items-center justify-center p-4 text-center">
                    <div className="bg-white p-10 md:p-16 rounded-[40px] shadow-2xl max-w-lg w-full border-t-[12px] border-green-500 animate-fade-in text-slate-800">
                        <h2 className="text-2xl md:text-3xl font-black mb-6 leading-tight">Danke f√ºrs Ausprobieren unserer Webseite!</h2>
                        <p className="text-lg text-slate-600 mb-10 leading-relaxed">Bitte beantworten Sie nun noch ein paar abschlie√üende Fragen. Klicken Sie dazu bitte auf diesen Button, um zur√ºck zum Fragebogen zu kommen:</p>
                        {targetUrl ? <a href={targetUrl} className="block w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-5 rounded-2xl shadow-xl transition-all transform active:scale-95 no-underline text-xl">Zur√ºck zum Fragebogen</a> : <div className="p-4 bg-red-50 text-red-600 rounded-xl">Fehler: Sitzungstoken nicht gefunden.</div>}
                    </div>
                </div>
            );
        };

        function App() {
            const [step, setStep] = useState('intro');
            const [cookieChoice, setCookieChoice] = useState(null);
            const [bannerVisible, setBannerVisible] = useState(false);
            const [groupID, setGroupID] = useState(0);
            const [finalData, setFinalData] = useState({});
            const [sessionToken, setSessionToken] = useState(null);
            const timers = useRef({ blogStart: 0, bannerStart: 0, formStart: 0, postBrowsingStart: 0 });
            const [times, setTimes] = useState({ blogTime: 0, cookieTime: 0, registrationTime: 0, postBrowsingTime: 0 });
            const audioRef = useRef(null);
            const audioManRef = useRef(null);

            useEffect(() => {
                const params = new URLSearchParams(window.location.search);
                const g = parseInt(params.get('g')) || 0;
                setGroupID(g);
                const t = params.get('t');
                if (t) setSessionToken(t);
                audioRef.current = new Audio('sound.mp3'); audioRef.current.volume = 0.5;
                audioManRef.current = new Audio('soundmann.mp3'); audioManRef.current.volume = 0.5;
            }, []);

            const handleStartStudy = () => {
                const unlockAudio = (audioObj) => { if (audioObj) { audioObj.volume = 0; audioObj.play().then(() => { audioObj.pause(); audioObj.currentTime = 0; audioObj.volume = 0.5; }).catch(e => console.log("Unlock failed", e)); } };
                unlockAudio(audioRef.current); unlockAudio(audioManRef.current);
                timers.current.blogStart = Date.now(); setStep('blog'); setTimeout(() => setBannerVisible(true), COOKIE_BANNER_DELAY_MS);
            };

            const handleBannerLoad = () => { timers.current.bannerStart = Date.now(); };
            const handleCookieDecision = (decision) => { const duration = Date.now() - timers.current.bannerStart; setTimes(prev => ({ ...prev, cookieTime: duration })); setCookieChoice(decision); setBannerVisible(false); };
            const handleGoToRegistration = () => { const duration = Date.now() - timers.current.blogStart; setTimes(prev => ({ ...prev, blogTime: duration })); timers.current.formStart = Date.now(); setStep('register'); };
            const handleRegistrationSubmit = (formData) => { const duration = Date.now() - timers.current.formStart; setTimes(prev => ({ ...prev, registrationTime: duration })); setFinalData(prev => ({ ...prev, groupID: groupID, ...formData, cookieChoice: cookieChoice })); setStep('loading'); };
            const handleLoadingFinished = () => { timers.current.postBrowsingStart = Date.now(); setStep('personalized_blog'); };
            const handleFinishStudy = () => { const duration = Date.now() - timers.current.postBrowsingStart; const completeData = { ...finalData, ...times, postBrowsingTime: duration }; setFinalData(completeData); setStep('end'); };

            return (
    <div className="font-sans text-gray-800 antialiased selection:bg-blue-100 selection:text-blue-900">
        {/* 1. Intro */}
        {step === 'intro' && <IntroScreen onStart={() => setStep('audio_test')} />}

        {/* 2. NEU: Audio Test */}
        {step === 'audio_test' && (
            <AudioTest 
                audioFile="Glocke.mp3" 
                onPassed={() => {
                    // Wenn bestanden, starte Timer und zeige Blog
                    timers.current.blogStart = Date.now();
                    setStep('blog');
                    setTimeout(() => setBannerVisible(true), COOKIE_BANNER_DELAY_MS);
                }} 
            />
        )}

        {/* 3. Blog & Cookie Banner */}
        {step === 'blog' && (
            <>
                <BlogPage onAction={handleGoToRegistration} mode="initial" cookieChoice={cookieChoice} />
                {bannerVisible && (
                    <CookieBanner 
                        group={groupID} 
                        onDecision={handleCookieDecision} 
                        audioObject={audioRef.current} 
                        onBannerLoad={handleBannerLoad} 
                    />
                )}
            </>
        )}

        {/* 4. Registrierung */}
        {step === 'register' && <RegistrationForm onSubmit={handleRegistrationSubmit} group={groupID} audioObject={audioManRef.current} />}
        
        {/* 5. Loading */}
        {step === 'loading' && <LoadingScreen onFinished={handleLoadingFinished} />}
        
        {/* 6. Personalisierter Blog */}
        {step === 'personalized_blog' && <BlogPage onAction={handleFinishStudy} mode="personalized" cookieChoice={cookieChoice} />}
        
        {/* 7. Ende */}
        {step === 'end' && <EndScreen data={finalData} sessionToken={sessionToken} />}
    </div>
);
        }
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
